<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Student Management System</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">


     <style>
        body {
            background: #ffffff;
            font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: aliceblue;
        }

        .student-management-system {
            padding-top: 50px;
            max-width: 1200px;
            margin: auto;
        }

        /* ---------- TITLE ---------- */
        .page-title {
            font-size: 40px;
            font-weight: 800;
            color: #0d6efd;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        /* ---------- ADD BUTTON ---------- */
        .add-btn {
            background: #0d6efd;
            color: #fff;
            font-weight: 600;
            border-radius: 8px;
            padding: 10px 18px;
            border: none;
        }

        /* ---------- SECTION HEADINGS ---------- */
        .section-title {
            font-size: 28px;
            font-weight: 700;
            margin: 35px 0 18px;
        }

        .section-title.college {
            color: #198754;
        }

        .section-title.department {
            color: #f4b400;
        }

        .section-title.student {
            color: #0d6efd;
        }

        /* ---------- CARD BOX (College & Dept) ---------- */
        .card-box {
            background: #ffffff;
            border-radius: 10px;
            padding: 14px;
            text-align: center;
            font-size: 16px;
            font-weight: 500;
            border: 1px solid #e0e0e0;
            transition: all 0.2s ease;
            position: relative;
        }

        .card-box:hover {
            box-shadow: 0 6px 14px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }

        /* ---------- STUDENT CARD ---------- */
        .student-card {
            background: #ffffff;
            border-radius: 14px;
            padding: 20px;
            text-align: center;
            border: 1px solid #e0e0e0;
            transition: all 0.25s ease;
            position: relative;
            height: 100%;
        }

        .student-card:hover {
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
            transform: translateY(-3px);
        }

        .student-photo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 10px;
        }

        .student-card h5 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .student-card p {
            margin: 0;
            font-size: 14px;
            color: #555;
        }

        /* ---------- ACTION ICONS ---------- */
        .card-actions {
            position: absolute;
            top: 10px;
            right: 12px;
            display: flex;
            gap: 10px;
        }

        .card-actions i {
            font-size: 16px;
            cursor: pointer;
            color: #6c757d;
        }

        .card-actions i:hover {
            color: #0d6efd;
        }
    </style>
   

</head>

<body>
    <div class="student-management-system">
        <h2 class="text-center text-primary mb-4">
            Student Management System
        </h2>

       <!-- Colleges -->
<h4 class="text-success mb-3">Colleges</h4>
<div class="row mb-4">
    {% for college in colleges %}
    <div class="col-md-4 mb-2 position-relative">
        <div class="card-box d-flex justify-content-between align-items-center">
            {{ college.college_name }}
            <div class="card-actions">
                <!-- Edit College -->
                <i class="bi bi-pencil-square" data-bs-toggle="modal" data-bs-target="#editCollegeModal{{ college.cid }}"></i>

                <!-- Delete College -->
                <i class="bi bi-trash-fill text-danger" data-bs-toggle="modal" data-bs-target="#deleteCollegeModal{{ college.cid }}"></i>
            </div>
        </div>
    </div>

    <!-- Edit College Modal -->
    <div class="modal fade" id="editCollegeModal{{ college.cid }}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-4">
                <div class="modal-header bg-warning text-white rounded-top-4">
                    <h5 class="modal-title">Edit College</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form method="POST" action="{% url 'edit_college' college.cid %}">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label class="form-label">College Name</label>
                            <input type="text" name="college_name" class="form-control" value="{{ college.college_name }}" required>
                        </div>
                        <div class="text-end">
                            <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-warning">Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete College Modal -->
    <div class="modal fade" id="deleteCollegeModal{{ college.cid }}" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-4">
                <div class="modal-header bg-danger text-white rounded-top-4">
                    <h5 class="modal-title">Confirm Delete</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    Are you sure you want to delete college "<strong>{{ college.college_name }}</strong>"?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <a href="{% url 'delete_college' college.cid %}" class="btn btn-danger">Delete</a>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

        <!-- Departments -->
        <h4 class="text-warning mb-3">Departments</h4>
        <div class="row mb-4">
            {% for dept in departments %}
            <div class="col-md-3 mb-2 position-relative">
                <div class="card-box d-flex justify-content-between align-items-center">
                    {{ dept.dept_name }}
                    <div class="card-actions">
                        <!-- Edit Department -->
                        <i class="bi bi-pencil-square" data-bs-toggle="modal" data-bs-target="#editDeptModal{{ dept.did }}"></i>

                        <!-- Delete Department -->
                        <i class="bi bi-trash-fill text-danger" data-bs-toggle="modal" data-bs-target="#deleteDeptModal{{ dept.did }}"></i>
                    </div>
                </div>
            </div>

            <!-- Edit Department Modal -->
            <div class="modal fade" id="editDeptModal{{ dept.did }}" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content rounded-4">
                        <div class="modal-header bg-warning text-white rounded-top-4">
                            <h5 class="modal-title"> Edit Department</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <form method="POST" action="{% url 'edit_department' dept.did %}">
                                {% csrf_token %}
                                <div class="mb-3">
                                    <label class="form-label">Department Name</label>
                                    <input type="text" name="department_name" class="form-control" value="{{ dept.dept_name }}" required>
                                </div>
                                <div class="text-end">
                                    <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                                    <button type="submit" class="btn btn-warning">Save</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delete Department Modal -->
            <div class="modal fade" id="deleteDeptModal{{ dept.did }}" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content rounded-4">
                        <div class="modal-header bg-danger text-white rounded-top-4">
                            <h5 class="modal-title">Confirm Delete</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to delete department "<strong>{{ dept.dept_name }}</strong>"?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <a href="{% url 'delete_department' dept.did %}" class="btn btn-danger">Delete</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Add Student Button -->
        <div class="text-center mb-4">
            <button class="btn btn-success px-4 py-2" data-bs-toggle="modal" data-bs-target="#addStudentModal">
                Add Student
            </button>
        </div>

        <!-- Students -->
        <h4 class="text-info mb-3">Students</h4>
        <div class="row">
            {% for s in students %}
            <div class="col-md-4 mb-3 position-relative">
                <div class="student-card">
                    <a href="{% url 'student_profile' s.sid %}" style="text-decoration:none;color:inherit; display:flex;flex-direction:column; align-items:center;justify-content:center;height:100%;">
                        {% if s.photo %}
                        <img src="{{ s.photo.url }}" class="student-photo mb-2">
                        {% endif %}
                        <h5>{{ s.sname }}</h5>
                        <p>Age: {{ s.sage }}</p>
                        <p>{{ s.college.college_name }}</p>
                        <p>{{ s.department.dept_name }}</p>
                    </a>
                </div>
            </div>

            <!-- Edit Student Modal -->
            <div class="modal fade" id="editStudentModal{{ s.sid }}" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered">
                    <div class="modal-content rounded-4">
                        <div class="modal-header bg-warning text-white rounded-top-4">
                            <h5 class="modal-title">Edit Student</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            <form method="POST" action="{% url 'edit_student' s.sid %}" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Student Name</label>
                                        <input type="text" name="student_name" class="form-control" value="{{ s.sname }}" required>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Age</label>
                                        <input type="number" name="student_age" class="form-control" value="{{ s.sage }}" required>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Joined Year</label>
                                        <input type="number" name="joined_year" class="form-control"
                                        min="2000" max="{{ current_year }}" value="{{ s.joined_year }}" required> 
                                    </div>

                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Photo</label>
                                        <input type="file" name="student_image" class="form-control">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">College</label>
                                        <select name="college" class="form-select" required>
                                            {% for college in colleges %}
                                            <option value="{{ college.cid }}" {% if college.id == s.college.cid %}selected{% endif %}>
                                                {{ college.college_name }}
                                            </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Department</label>
                                        <select name="department" class="form-select" required>
                                            {% for dept in departments %}
                                            <option value="{{ dept.did }}" {% if dept.did == s.department.id %}selected{% endif %}>
                                                {{ dept.dept_name }}
                                            </option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                                <div class="text-end">
                                    <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                                    <button type="submit" class="btn btn-warning">Save</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Delete Student Modal -->
            <div class="modal fade" id="deleteStudentModal{{ s.sid }}" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content rounded-4">
                        <div class="modal-header bg-danger text-white rounded-top-4">
                            <h5 class="modal-title">Confirm Delete</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to delete student "<strong>{{ s.sname }}</strong>"?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <a href="{% url 'delete_student' s.sid %}" class="btn btn-danger">Delete</a>
                        </div>
                    </div>
                </div>
            </div>

            {% endfor %}
        </div>

        <!-- Add Student Modal -->
        <div class="modal fade" id="addStudentModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content rounded-4">
                    <div class="modal-header bg-success text-white rounded-top-4">
                        <h5 class="modal-title">Add Student</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Student Name</label>
                                    <input type="text" name="student_name" class="form-control" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label class="form-label">Age</label>
                                    <input type="number" name="student_age" class="form-control" required>
                                </div>
                                <div class="col-md-3 mb-3">
                                    <label class="form-label">Joined Year</label>
                                    <input type="number" name="joined_year" class="form-control"
                                    min="2000" max="{{ current_year }}" value="{{ current_year }}" required> 
                                </div>

                                <div class="col-md-3 mb-3">
                                    <label class="form-label">Photo</label>
                                    <input type="file" name="student_image" class="form-control">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">College</label>
                                    <select name="college" class="form-select" required>
                                        <option value="">-- Select College --</option>
                                        {% for college in colleges %}
                                        <option value="{{ college.cid }}">{{ college.college_name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Department</label>
                                    <select name="department" class="form-select" required>
                                        <option value="">-- Select Department --</option>
                                        {% for dept in departments %}
                                        <option value="{{ dept.did }}">{{ dept.dept_name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="text-end">
                                <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-success">Save Student</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('hidden.bs.modal', function () {
        const form = modal.querySelector('form');
        if (form) form.reset();
    });
});
</script>

</body>

</html>
